<?xml version="1.0"?>
<exercises>
  <exercise>
    <title>Malware Analysis - Windows - Part 1</title>
    <difficulty>2</difficulty>
    <category>CND</category>
    <name>Malware_Analysis_P1</name>
    <dependencies></dependencies>
    <shortdescription>Analyze Malicious Windows Programs: Lab 7-1</shortdescription>
    <description>In this exercise you will analyze malicious windows programs using native windows commands and a debugger. The malicious application comes from Practical Malware Analysis, Chapter 7. </description>
    <tutorial>&lt;p&gt;&lt;strong&gt;Before running the malware, read through Chapter 7 of Practical Malware Analysis. It will help with doing the malware analysis exercises.&lt;/strong&gt;&lt;/p&gt;&#xD;
&lt;ol&gt;&#xD;
&lt;li&gt;Using your defense workstation, open up the directory in the share drive 'ShareFiles(S:)\Practical Malware Analysis Labs\BinaryCollection\Chapter7L'.&lt;/li&gt;&#xD;
&lt;li&gt;Select 'Lab07_01' and run it. The application will create a window. Keep the window open and do not close it until all questions are answered.&lt;/li&gt;&#xD;
&lt;li&gt;Analyze the malware using native windows commands, and the debugger of your choice--OllyDbg, ImmunityDebugger, IDA Pro Free-- in the share drive. I recommend IDA Pro.&lt;/li&gt;&#xD;
&lt;/ol&gt;</tutorial>
    <video>https://www.youtube.com/embed/fgMl0Uqiey8</video>
    <question>
      <text>How does this program ensure that it continues running (achieves persistence) when the computer is restarted?</text>
      <type>multiple</type>
      <answer>The program creates the service MalService.</answer>
      <wrong>Program creates a bookmark that is started up every time the browser is opened.</wrong>
      <wrong>The program alters the system ntdll.dll module.</wrong>
      <wrong>The program creates a scheduled job.</wrong>
    </question>
    <question>
      <text>Why does this program use a mutex?</text>
      <type>multiple</type>
      <answer>To ensure that only one copy of the program is running at a time. </answer>
      <wrong>To ensure that legitimate code is mutated to perform a different function than intended.</wrong>
      <wrong>To ensure that only the code within the mutex is run and not that of any other program.</wrong>
      <wrong>To ensure that MalService evades detection.</wrong>
    </question>
    <question>
      <text>What is a good host-based signature to use for detecting this program?</text>
      <type>multiple</type>
      <answer>Search for a mutex named HGL345 and for the service MalService.</answer>
      <wrong>Search for the modified kerne132.dll</wrong>
      <wrong>Search for programs that have a timer running longer than 10000 seconds.</wrong>
      <wrong>Search for a mutex named HG1345.</wrong>
    </question>
    <question>
      <text>What is a good network-based signature to use for detecting this malware?</text>
      <type>multiple</type>
      <answer>User agent string Internet Explorer 8.0 and communicates with www.malwareanalysisbook.com.</answer>
      <wrong>User agent string Mozilla Firefox 8.0 and communicates with www.malwareanalysisbook.com.</wrong>
      <wrong>User agent string Internet Explorer 7.5 and communicates with www.malwareanalysisbook.com.</wrong>
      <wrong>User agent string Internet Explorer 7.0 and communicates with www.malwareanalysis.com.</wrong>
    </question>
    <question>
      <text>What is the purpose of this program?</text>
      <type>multiple</type>
      <answer>This program waits until midnight on January 1, 2100, and then sends many requests to http://www.malwareanalysisbook.com/, to conduct a distributed denial-of-service (DDoS) attack against the site.</answer>
      <wrong>This program waits until midnight on January 1, 2100, and then connects to http://www.malwareanalysisbook.com to download additional malware onto your computer.</wrong>
      <wrong>This program waits until midnight on January 1, 2100, and then connects to http://www.malwareanalysisbook.com to post the user credentials and network information of your computer.</wrong>
      <wrong>This program waits until midnight on January 1, 2100, and then connects to http://www.malwareanalysisbook.com and logins to the IRC on the site for additional commands from a bot controller.</wrong>
    </question>
    <question>
      <text>When will this program finish executing?</text>
      <type>multiple</type>
      <answer>The program will never finish. It waits on a timer until the year 2100, and then creates 20 threads, each of which runs in an infinite loop.</answer>
      <wrong>The program finishes when a user opens a browser.</wrong>
      <wrong>The program finishes in 2100 when the timer runs out.</wrong>
    </question>
  </exercise>
</exercises>
